@model Metawision.Blog.Models.DTO.imageDTO


@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    <div class="form-horizontal">
        @*<h4>imageDTO</h4>*@
        <hr />
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        <div class="form-group">
            @Html.LabelFor(model => model.pic, htmlAttributes: new { @class = "control-label" })
            <div class="col-md-12">
                @Html.EditorFor(model => model.pic, new { htmlAttributes = new { @class = "form-control", id = "imageTxt", style = "visibility:hidden; display:none" } })
                <input type="file" name="fileSelect" id="fileSelect" style="visibility:hidden; display:none" />
                <img src="~/image/MWDD.jpg" id="thImage" class="img-responsive p-1" />
                @Html.ValidationMessageFor(model => model.pic, "", new { @class = "text-danger" })
            </div>
            <div class="col-md-6 direction-rtl">
                <input type="button" onclick="uploadToView()" value="بارگذاری تصویر" class="btn btn-primary" />
            </div>
        </div>
    </div>
}

<script>

    function uploadToView() {
        if ($("#imageTxt").val().length > 0) {
            $("#imageTxtTwo").val($("#imageTxt").val());
            $("#theIndexImage").attr("src", $("#thImage").attr("src"));
            alert("تصویر بارگذاری شد");
        }
        else {
            alert("فایلی انتخاب نشده");
        }
    }

    $("#thImage").click(function () { $("#fileSelect").click(); });

    if (window.File && window.FileReader && window.FileList && window.Blob) {

        document.getElementById('fileSelect').addEventListener('change',

            function (evt) {
                var files = evt.target.files;
                var file = files[0];
                if (files && file) {
                    var reader = new FileReader();

                    reader.onload = function (readerEvt) {
                        var binaryString = readerEvt.target.result;
                        var base64Image = btoa(binaryString);
                        var base64Link = "data:image/png;base64, " + base64Image;
                        $("#imageTxt").val(base64Link);
                        $("#thImage").attr("src", base64Link);
                    };
                    reader.readAsBinaryString(file);
                }
            }
            , false);
    }
    else {
        alert('The File APIs are not fully supported in this browser.');
    }

</script>